<!doctype html>
<html lang="pt-BR">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Card√°pio Bolli</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="/_sdk/data_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Della Respira', serif;
      background: linear-gradient(135deg, #790C21 0%, #8F152D 100%);
      color: #FFFBE3;
      min-height: 100%;
      display: flex;
      flex-direction: column;
    }

    * {
      box-sizing: border-box;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 40px 20px;
      width: 100%;
    }

    .header {
      text-align: center;
      margin-bottom: 50px;
    }

    .logo-space {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 120px;
      margin-bottom: 20px;
    }

    .logo-placeholder {
      width: 300px;
      height: 120px;
      border: none;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: transparent;
      transition: all 0.3s ease;
    }

    .logo-placeholder span {
      color: #FFFBE3;
      font-size: 1.1em;
      font-weight: bold;
      opacity: 0.8;
      text-align: center;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 30px;
      margin-bottom: 50px;
    }

    .product-card {
      background: rgba(255, 251, 227, 0.1);
      border: 2px solid #FFFBE3;
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      backdrop-filter: blur(10px);
    }

    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .product-image {
      width: 100%;
      height: 200px;
      background: rgba(255, 251, 227, 0.2);
      border-radius: 10px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 4em;
      border: 2px dashed #FFFBE3;
    }

    .product-name {
      font-size: 1.4em;
      font-weight: bold;
      margin: 0 0 10px 0;
      color: #FFFBE3;
    }

    .product-description {
      font-size: 0.9em;
      color: rgba(255, 251, 227, 0.8);
      margin: 0 0 15px 0;
      line-height: 1.4;
      font-style: italic;
    }

    .product-price {
      font-size: 1.8em;
      font-weight: bold;
      color: #FFFBE3;
      margin: 0 0 20px 0;
    }

    .quantity-selector {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-top: 15px;
    }

    .quantity-btn {
      background: #FFFBE3;
      color: #790C21;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 1.2em;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .quantity-btn:hover {
      background: #fff;
      transform: scale(1.1);
    }

    .quantity-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .quantity-display {
      font-size: 1.3em;
      font-weight: bold;
      min-width: 30px;
      text-align: center;
    }

    .cart-section {
      background: rgba(255, 251, 227, 0.1);
      border: 2px solid #FFFBE3;
      border-radius: 15px;
      padding: 30px;
      margin-bottom: 30px;
      backdrop-filter: blur(10px);
    }

    .cart-title {
      font-size: 2em;
      font-weight: bold;
      text-align: center;
      margin: 0 0 25px 0;
      color: #FFFBE3;
    }

    .cart-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255, 251, 227, 0.3);
    }

    .cart-item:last-child {
      border-bottom: none;
    }

    .cart-item-name {
      font-weight: bold;
      flex: 1;
    }

    .cart-item-quantity {
      margin: 0 15px;
      opacity: 0.8;
    }

    .cart-item-price {
      font-weight: bold;
      min-width: 80px;
      text-align: right;
    }

    .cart-total {
      border-top: 2px solid #FFFBE3;
      padding-top: 15px;
      margin-top: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.5em;
      font-weight: bold;
    }

    .cart-empty {
      text-align: center;
      opacity: 0.7;
      font-style: italic;
      padding: 20px 0;
    }

    .order-section {
      text-align: center;
      padding: 40px 20px;
    }

    .order-button {
      background: #FFFBE3;
      color: #790C21;
      border: none;
      padding: 20px 60px;
      font-size: 1.5em;
      font-weight: bold;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
      font-family: 'Della Respira', serif;
    }

    .order-button:hover {
      background: #fff;
      transform: scale(1.05);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
    }

    .order-button:active {
      transform: scale(0.98);
    }

    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: #FFFBE3;
      color: #790C21;
      padding: 20px 40px;
      border-radius: 10px;
      font-weight: bold;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .toast.show {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }

    .checkout-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      padding: 20px;
      box-sizing: border-box;
    }

    .checkout-modal.show {
      display: flex;
    }

    .checkout-content {
      background: linear-gradient(135deg, #790C21 0%, #8F152D 100%);
      border: 2px solid #FFFBE3;
      border-radius: 15px;
      padding: 30px;
      max-width: 600px;
      width: 100%;
      max-height: 90%;
      overflow-y: auto;
      color: #FFFBE3;
    }

    .checkout-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
    }

    .checkout-title {
      font-size: 2em;
      font-weight: bold;
      margin: 0;
    }

    .close-btn {
      background: none;
      border: none;
      color: #FFFBE3;
      font-size: 2em;
      cursor: pointer;
      padding: 0;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s ease;
    }

    .close-btn:hover {
      background: rgba(255, 251, 227, 0.2);
    }

    .form-section {
      margin-bottom: 25px;
    }

    .section-title {
      font-size: 1.3em;
      font-weight: bold;
      margin-bottom: 15px;
      color: #FFFBE3;
      border-bottom: 1px solid rgba(255, 251, 227, 0.3);
      padding-bottom: 5px;
    }

    .form-group {
      margin-bottom: 15px;
    }

    .form-label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #FFFBE3;
    }

    .form-input {
      width: 100%;
      padding: 12px;
      border: 2px solid #FFFBE3;
      border-radius: 8px;
      background: rgba(255, 251, 227, 0.1);
      color: #FFFBE3;
      font-size: 1em;
      font-family: 'Della Respira', serif;
    }

    .form-input::placeholder {
      color: rgba(255, 251, 227, 0.6);
    }

    .form-input:focus {
      outline: none;
      background: rgba(255, 251, 227, 0.2);
      box-shadow: 0 0 10px rgba(255, 251, 227, 0.3);
    }

    .radio-group {
      display: flex;
      gap: 20px;
      margin-top: 10px;
    }

    .radio-option {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
    }

    .radio-option input[type="radio"] {
      width: 18px;
      height: 18px;
      accent-color: #FFFBE3;
    }

    .delivery-address {
      display: none;
      margin-top: 15px;
      padding: 15px;
      background: rgba(255, 251, 227, 0.1);
      border-radius: 8px;
      border: 1px solid rgba(255, 251, 227, 0.3);
    }

    .delivery-address.show {
      display: block;
    }

    .date-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }

    .date-option {
      padding: 10px;
      border: 2px solid #FFFBE3;
      border-radius: 8px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
      background: rgba(255, 251, 227, 0.1);
    }

    .date-option:hover {
      background: rgba(255, 251, 227, 0.2);
    }

    .date-option.selected {
      background: #FFFBE3;
      color: #790C21;
    }

    .order-summary {
      background: rgba(255, 251, 227, 0.1);
      border: 1px solid rgba(255, 251, 227, 0.3);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
    }

    .summary-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .summary-total {
      border-top: 1px solid rgba(255, 251, 227, 0.3);
      padding-top: 10px;
      margin-top: 10px;
      font-weight: bold;
    }

    .payment-info {
      background: rgba(255, 251, 227, 0.15);
      border: 2px solid #FFFBE3;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      text-align: center;
    }

    .payment-highlight {
      font-size: 1.2em;
      font-weight: bold;
      color: #FFFBE3;
    }

    .checkout-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .btn-secondary {
      background: transparent;
      color: #FFFBE3;
      border: 2px solid #FFFBE3;
      padding: 12px 30px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1em;
      font-weight: bold;
      transition: all 0.3s ease;
      font-family: 'Della Respira', serif;
    }

    .btn-secondary:hover {
      background: rgba(255, 251, 227, 0.2);
    }

    .btn-primary {
      background: #FFFBE3;
      color: #790C21;
      border: 2px solid #FFFBE3;
      padding: 12px 30px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 1em;
      font-weight: bold;
      transition: all 0.3s ease;
      font-family: 'Della Respira', serif;
    }

    .btn-primary:hover {
      background: #fff;
      transform: scale(1.05);
    }

    @media (max-width: 768px) {
      .container {
        padding: 20px 15px;
      }

      .header {
        margin-bottom: 30px;
      }

      .logo-space {
        min-height: 80px;
        margin-bottom: 15px;
      }

      .logo-placeholder {
        width: 200px;
        height: 80px;
      }

      .logo-placeholder span {
        font-size: 0.9em;
      }

      .menu-grid {
        grid-template-columns: 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      .product-card {
        padding: 20px;
      }

      .product-image {
        height: 150px;
        font-size: 3em;
        margin-bottom: 15px;
      }

      .product-name {
        font-size: 1.2em;
        margin-bottom: 8px;
      }

      .product-description {
        font-size: 0.85em;
        margin-bottom: 12px;
      }

      .product-price {
        font-size: 1.5em;
        margin-bottom: 15px;
      }

      .quantity-selector {
        gap: 12px;
      }

      .quantity-btn {
        width: 35px;
        height: 35px;
        font-size: 1.1em;
      }

      .quantity-display {
        font-size: 1.2em;
      }

      .cart-section {
        padding: 20px;
        margin-bottom: 20px;
      }

      .cart-title {
        font-size: 1.6em;
        margin-bottom: 20px;
      }

      .cart-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 5px;
        padding: 15px 0;
      }

      .cart-item-name {
        font-size: 1em;
        width: 100%;
      }

      .cart-item-details {
        display: flex;
        justify-content: space-between;
        width: 100%;
        align-items: center;
      }

      .cart-item-quantity {
        margin: 0;
        font-size: 0.9em;
      }

      .cart-item-price {
        font-size: 1.1em;
        font-weight: bold;
      }

      .cart-total {
        font-size: 1.3em;
        padding-top: 12px;
        margin-top: 12px;
      }

      .order-section {
        padding: 20px;
      }

      .order-button {
        padding: 15px 40px;
        font-size: 1.2em;
        width: 100%;
        max-width: 300px;
      }

      .checkout-modal {
        padding: 10px;
      }

      .checkout-content {
        padding: 20px;
        max-height: 95%;
        border-radius: 10px;
      }

      .checkout-title {
        font-size: 1.6em;
      }

      .section-title {
        font-size: 1.1em;
      }

      .form-input {
        padding: 10px;
        font-size: 16px; /* Evita zoom no iOS */
      }

      .radio-group {
        flex-direction: column;
        gap: 12px;
        align-items: flex-start;
      }

      .date-grid {
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
      }

      .date-option {
        padding: 8px 4px;
        font-size: 0.85em;
      }

      .checkout-buttons {
        flex-direction: column;
        gap: 10px;
      }

      .btn-primary, .btn-secondary {
        width: 100%;
        padding: 15px;
        font-size: 1.1em;
      }

      .toast {
        bottom: 20px;
        left: 10px;
        right: 10px;
        transform: translateX(0) translateY(100px);
        padding: 15px 20px;
        font-size: 0.9em;
        text-align: center;
      }

      .toast.show {
        transform: translateX(0) translateY(0);
      }

      .payment-info {
        padding: 12px;
        font-size: 0.9em;
      }

      .payment-highlight {
        font-size: 1.1em;
      }

      .order-summary {
        padding: 12px;
      }

      .summary-item {
        font-size: 0.9em;
        margin-bottom: 6px;
      }
    }

    @media (max-width: 480px) {
      .container {
        padding: 15px 10px;
      }

      .product-card {
        padding: 15px;
      }

      .product-name {
        font-size: 1.1em;
      }

      .product-price {
        font-size: 1.4em;
      }

      .cart-section {
        padding: 15px;
      }

      .checkout-content {
        padding: 15px;
      }

      .date-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <main>
   <div class="container">
    <header class="header">
     <div class="logo-space">
      <div class="logo-container" id="logoContainer"><img id="logoImage" src="" alt="Logo da Confeitaria" style="display: none; max-width: 100%; max-height: 120px; object-fit: contain;" onerror="this.style.display='none'; document.getElementById('logoPlaceholder').style.display='flex';">
       <div class="logo-placeholder" id="logoPlaceholder">
       </div>
      </div>
     </div>
    </header>
    <div class="menu-grid">
     <div class="product-card">
      <div class="product-image">
       üç™
      </div>
      <h2 class="product-name" id="product1Name">Lata de cookies</h2>
      <p class="product-description" id="product1Description">8 cookies m√©dios recheados nos sabores: panetone, biscoito de gengibre, red velvet e pistache.</p>
      <p class="product-price" id="product1Price">R$ 70</p>
      <div class="quantity-selector"><button class="quantity-btn" onclick="changeQuantity(1, -1)">-</button> <span class="quantity-display" id="quantity1">0</span> <button class="quantity-btn" onclick="changeQuantity(1, 1)">+</button>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image">
       üéÅ
      </div>
      <h2 class="product-name" id="product2Name">Lata suspiro</h2>
      <p class="product-description" id="product2Description">Suspiros modelados, tradicionais e recheados nos sabores panetone e biscoito de gengibre.</p>
      <p class="product-price" id="product2Price">R$ 60</p>
      <div class="quantity-selector"><button class="quantity-btn" onclick="changeQuantity(2, -1)">-</button> <span class="quantity-display" id="quantity2">0</span> <button class="quantity-btn" onclick="changeQuantity(2, 1)">+</button>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image">
       ü•†
      </div>
      <h2 class="product-name" id="product3Name">Pote de cookies</h2>
      <p class="product-description" id="product3Description">Mini cookies tradicionais.</p>
      <p class="product-price" id="product3Price">R$ 35</p>
      <div class="quantity-selector"><button class="quantity-btn" onclick="changeQuantity(3, -1)">-</button> <span class="quantity-display" id="quantity3">0</span> <button class="quantity-btn" onclick="changeQuantity(3, 1)">+</button>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image">
       ü´ô
      </div>
      <h2 class="product-name" id="product4Name">Pote de suspiro</h2>
      <p class="product-description" id="product4Description">Suspiros natalinos modelados.</p>
      <p class="product-price" id="product4Price">R$ 35</p>
      <div class="quantity-selector"><button class="quantity-btn" onclick="changeQuantity(4, -1)">-</button> <span class="quantity-display" id="quantity4">0</span> <button class="quantity-btn" onclick="changeQuantity(4, 1)">+</button>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image">
       üéÖ
      </div>
      <h2 class="product-name" id="product5Name">Cart√£o suspiro papai noel</h2>
      <p class="product-price" id="product5Price">R$ 15</p>
      <div class="quantity-selector"><button class="quantity-btn" onclick="changeQuantity(5, -1)">-</button> <span class="quantity-display" id="quantity5">0</span> <button class="quantity-btn" onclick="changeQuantity(5, 1)">+</button>
      </div>
     </div>
     <div class="product-card">
      <div class="product-image">
       üéÑ
      </div>
      <h2 class="product-name" id="product6Name">Suspiro √°rvore de natal</h2>
      <p class="product-price" id="product6Price">R$ 12</p>
      <div class="quantity-selector"><button class="quantity-btn" onclick="changeQuantity(6, -1)">-</button> <span class="quantity-display" id="quantity6">0</span> <button class="quantity-btn" onclick="changeQuantity(6, 1)">+</button>
      </div>
     </div>
    </div>
    <div class="cart-section">
     <h2 class="cart-title">üõí Carrinho</h2>
     <div id="cartItems">
      <div class="cart-empty">
       Seu carrinho est√° vazio
      </div>
     </div>
     <div class="cart-total" id="cartTotal" style="display: none;"><span>Total:</span> <span id="totalPrice">R$ 0</span>
     </div>
    </div>
    <div class="order-section"><button class="order-button" id="orderButton">Fazer Pedido</button>
    </div>
   </div>
  </main>
  <div class="toast" id="toast">
   Pedido iniciado! Entre em contato para finalizar.
  </div><!-- Modal de Checkout -->
  <div class="checkout-modal" id="checkoutModal">
   <div class="checkout-content">
    <div class="checkout-header">
     <h2 class="checkout-title">Finalizar Pedido</h2><button class="close-btn" onclick="closeCheckout()">√ó</button>
    </div>
    <form id="checkoutForm"><!-- Dados Pessoais -->
     <div class="form-section">
      <h3 class="section-title">üìã Dados Pessoais</h3>
      <div class="form-group"><label for="customerName" class="form-label">Nome Completo *</label> <input type="text" id="customerName" class="form-input" placeholder="Digite seu nome completo" required>
      </div>
      <div class="form-group"><label for="customerEmail" class="form-label">E-mail *</label> <input type="email" id="customerEmail" class="form-input" placeholder="seu@email.com" required>
      </div>
      <div class="form-group"><label for="customerPhone" class="form-label">Celular *</label> <input type="tel" id="customerPhone" class="form-input" placeholder="(11) 99999-9999" required>
      </div>
     </div><!-- Tipo de Entrega -->
     <div class="form-section">
      <h3 class="section-title">üöö Tipo de Entrega</h3>
      <div class="radio-group"><label class="radio-option"> <input type="radio" name="deliveryType" value="pickup" checked onchange="toggleDeliveryAddress()"> <span>Retirada na loja</span> </label> <label class="radio-option"> <input type="radio" name="deliveryType" value="delivery" onchange="toggleDeliveryAddress()"> <span>Entrega</span> </label>
      </div>
      <div class="delivery-address" id="deliveryAddress">
       <div class="form-group"><label for="address" class="form-label">Endere√ßo Completo *</label> <input type="text" id="address" class="form-input" placeholder="Rua, n√∫mero, bairro, cidade">
       </div>
       <div class="form-group"><label for="addressComplement" class="form-label">Complemento</label> <input type="text" id="addressComplement" class="form-input" placeholder="Apartamento, bloco, refer√™ncia">
       </div>
      </div>
     </div><!-- Data de Entrega -->
     <div class="form-section">
      <h3 class="section-title">üìÖ Data Dispon√≠vel</h3>
      <div class="date-grid" id="dateOptions"><!-- Datas ser√£o geradas dinamicamente -->
      </div>
     </div><!-- Resumo do Pedido -->
     <div class="form-section">
      <h3 class="section-title">üì¶ Resumo do Pedido</h3>
      <div class="order-summary" id="orderSummary"><!-- Resumo ser√° gerado dinamicamente -->
      </div>
     </div><!-- Informa√ß√µes de Pagamento -->
     <div class="payment-info">
      <div class="payment-highlight">
       üí≥ Pagamento Antecipado
      </div>
      <p>Para confirmar seu pedido √© necess√°rio o pagamento de <strong>50% do valor total</strong> antecipadamente.</p>
      <p>Ap√≥s finalizar o pedido, voc√™ receber√° as instru√ß√µes de pagamento por e-mail.</p>
     </div><!-- Bot√µes -->
     <div class="checkout-buttons"><button type="button" class="btn-secondary" onclick="closeCheckout()">Cancelar</button> <button type="submit" class="btn-primary">Confirmar Pedido</button>
     </div>
    </form>
   </div>
  </div>
  <script>
    const defaultConfig = {
      background_color: "#790C21",
      secondary_color: "#8F152D",
      text_color: "#FFFBE3",
      button_color: "#FFFBE3",
      button_text_color: "#790C21",
      font_family: "Della Respira, serif",
      font_size: 16,
      logo_url: "",
      store_name: "Confeitaria Bolli",
      store_tagline: "Doces especiais para momentos especiais",
      product_1_name: "Lata de cookies",
      product_1_description: "8 cookies m√©dios recheados nos sabores: panetone, biscoito de gengibre, red velvet e pistache.",
      product_1_price: "R$ 70",
      product_2_name: "Lata suspiro",
      product_2_description: "Suspiros modelados, tradicionais e recheados nos sabores panetone e biscoito de gengibre.",
      product_2_price: "R$ 60",
      product_3_name: "Pote de cookies",
      product_3_description: "Mini cookies tradicionais.",
      product_3_price: "R$ 35",
      product_4_name: "Pote de suspiro",
      product_4_description: "Suspiros natalinos modelados.",
      product_4_price: "R$ 35",
      product_5_name: "Cart√£o suspiro papai noel",
      product_5_price: "R$ 15",
      product_6_name: "Suspiro √°rvore de natal",
      product_6_price: "R$ 12",
      order_button_text: "Fazer Pedido"
    };

    async function onConfigChange(config) {
      const fontFamily = config.font_family || defaultConfig.font_family;
      const fontSize = config.font_size || defaultConfig.font_size;
      const backgroundColor = config.background_color || defaultConfig.background_color;
      const secondaryColor = config.secondary_color || defaultConfig.secondary_color;
      const textColor = config.text_color || defaultConfig.text_color;
      const buttonColor = config.button_color || defaultConfig.button_color;
      const buttonTextColor = config.button_text_color || defaultConfig.button_text_color;

      document.body.style.fontFamily = `${fontFamily}, serif`;
      document.body.style.background = `linear-gradient(135deg, ${backgroundColor} 0%, ${secondaryColor} 100%)`;
      document.body.style.color = textColor;

      // Logo space styling (sem texto para ajustar)
      document.querySelectorAll('.product-name').forEach(el => {
        el.style.fontSize = `${fontSize * 1.4}px`;
        el.style.color = textColor;
      });
      document.querySelectorAll('.product-price').forEach(el => {
        el.style.fontSize = `${fontSize * 1.8}px`;
        el.style.color = textColor;
      });

      const orderButton = document.getElementById('orderButton');
      orderButton.style.background = buttonColor;
      orderButton.style.color = buttonTextColor;
      orderButton.style.fontSize = `${fontSize * 1.5}px`;

      // Atualizar logo
      const logoUrl = config.logo_url || defaultConfig.logo_url;
      const logoImage = document.getElementById('logoImage');
      const logoPlaceholder = document.getElementById('logoPlaceholder');
      
      if (logoUrl && logoUrl.trim()) {
        logoImage.src = logoUrl;
        logoImage.style.display = 'block';
        logoPlaceholder.style.display = 'none';
      } else {
        logoImage.style.display = 'none';
        logoPlaceholder.style.display = 'flex';
      }

      // Atualizar produtos
      document.getElementById('product1Name').textContent = config.product_1_name || defaultConfig.product_1_name;
      document.getElementById('product1Description').textContent = config.product_1_description || defaultConfig.product_1_description;
      document.getElementById('product1Price').textContent = config.product_1_price || defaultConfig.product_1_price;
      document.getElementById('product2Name').textContent = config.product_2_name || defaultConfig.product_2_name;
      document.getElementById('product2Description').textContent = config.product_2_description || defaultConfig.product_2_description;
      document.getElementById('product2Price').textContent = config.product_2_price || defaultConfig.product_2_price;
      document.getElementById('product3Name').textContent = config.product_3_name || defaultConfig.product_3_name;
      document.getElementById('product3Description').textContent = config.product_3_description || defaultConfig.product_3_description;
      document.getElementById('product3Price').textContent = config.product_3_price || defaultConfig.product_3_price;
      document.getElementById('product4Name').textContent = config.product_4_name || defaultConfig.product_4_name;
      document.getElementById('product4Description').textContent = config.product_4_description || defaultConfig.product_4_description;
      document.getElementById('product4Price').textContent = config.product_4_price || defaultConfig.product_4_price;
      document.getElementById('product5Name').textContent = config.product_5_name || defaultConfig.product_5_name;
      document.getElementById('product5Price').textContent = config.product_5_price || defaultConfig.product_5_price;
      document.getElementById('product6Name').textContent = config.product_6_name || defaultConfig.product_6_name;
      document.getElementById('product6Price').textContent = config.product_6_price || defaultConfig.product_6_price;
      document.getElementById('orderButton').textContent = config.order_button_text || defaultConfig.order_button_text;
    }

    function mapToCapabilities(config) {
      return {
        recolorables: [
          {
            get: () => config.background_color || defaultConfig.background_color,
            set: (value) => {
              config.background_color = value;
              if (window.elementSdk) window.elementSdk.setConfig({ background_color: value });
            }
          },
          {
            get: () => config.secondary_color || defaultConfig.secondary_color,
            set: (value) => {
              config.secondary_color = value;
              if (window.elementSdk) window.elementSdk.setConfig({ secondary_color: value });
            }
          },
          {
            get: () => config.text_color || defaultConfig.text_color,
            set: (value) => {
              config.text_color = value;
              if (window.elementSdk) window.elementSdk.setConfig({ text_color: value });
            }
          },
          {
            get: () => config.button_color || defaultConfig.button_color,
            set: (value) => {
              config.button_color = value;
              if (window.elementSdk) window.elementSdk.setConfig({ button_color: value });
            }
          },
          {
            get: () => config.button_text_color || defaultConfig.button_text_color,
            set: (value) => {
              config.button_text_color = value;
              if (window.elementSdk) window.elementSdk.setConfig({ button_text_color: value });
            }
          }
        ],
        borderables: [],
        fontEditable: {
          get: () => config.font_family || defaultConfig.font_family,
          set: (value) => {
            config.font_family = value;
            if (window.elementSdk) window.elementSdk.setConfig({ font_family: value });
          }
        },
        fontSizeable: {
          get: () => config.font_size || defaultConfig.font_size,
          set: (value) => {
            config.font_size = value;
            if (window.elementSdk) window.elementSdk.setConfig({ font_size: value });
          }
        }
      };
    }

    function mapToEditPanelValues(config) {
      return new Map([
        ["logo_url", config.logo_url || defaultConfig.logo_url],
        ["store_name", config.store_name || defaultConfig.store_name],
        ["store_tagline", config.store_tagline || defaultConfig.store_tagline],
        ["product_1_name", config.product_1_name || defaultConfig.product_1_name],
        ["product_1_description", config.product_1_description || defaultConfig.product_1_description],
        ["product_1_price", config.product_1_price || defaultConfig.product_1_price],
        ["product_2_name", config.product_2_name || defaultConfig.product_2_name],
        ["product_2_description", config.product_2_description || defaultConfig.product_2_description],
        ["product_2_price", config.product_2_price || defaultConfig.product_2_price],
        ["product_3_name", config.product_3_name || defaultConfig.product_3_name],
        ["product_3_description", config.product_3_description || defaultConfig.product_3_description],
        ["product_3_price", config.product_3_price || defaultConfig.product_3_price],
        ["product_4_name", config.product_4_name || defaultConfig.product_4_name],
        ["product_4_description", config.product_4_description || defaultConfig.product_4_description],
        ["product_4_price", config.product_4_price || defaultConfig.product_4_price],
        ["product_5_name", config.product_5_name || defaultConfig.product_5_name],
        ["product_5_price", config.product_5_price || defaultConfig.product_5_price],
        ["product_6_name", config.product_6_name || defaultConfig.product_6_name],
        ["product_6_price", config.product_6_price || defaultConfig.product_6_price],
        ["order_button_text", config.order_button_text || defaultConfig.order_button_text]
      ]);
    }

    let cart = {};
    let isDataSdkReady = false;
    const products = [
      { id: 1, name: "Lata de cookies", price: 70 },
      { id: 2, name: "Lata suspiro", price: 60 },
      { id: 3, name: "Pote de cookies", price: 35 },
      { id: 4, name: "Pote de suspiro", price: 35 },
      { id: 5, name: "Cart√£o suspiro papai noel", price: 15 },
      { id: 6, name: "Suspiro √°rvore de natal", price: 12 }
    ];

    function changeQuantity(productId, change) {
      const currentQuantity = cart[productId] || 0;
      const newQuantity = Math.max(0, currentQuantity + change);
      
      if (newQuantity === 0) {
        delete cart[productId];
      } else {
        cart[productId] = newQuantity;
      }
      
      document.getElementById(`quantity${productId}`).textContent = newQuantity;
      updateCart();
    }

    function updateCart() {
      const cartItemsContainer = document.getElementById('cartItems');
      const cartTotal = document.getElementById('cartTotal');
      const totalPriceElement = document.getElementById('totalPrice');
      
      if (Object.keys(cart).length === 0) {
        cartItemsContainer.innerHTML = '<div class="cart-empty">Seu carrinho est√° vazio</div>';
        cartTotal.style.display = 'none';
        return;
      }
      
      let cartHTML = '';
      let total = 0;
      
      Object.keys(cart).forEach(productId => {
        const product = products.find(p => p.id == productId);
        const quantity = cart[productId];
        const itemTotal = product.price * quantity;
        total += itemTotal;
        
        cartHTML += `
          <div class="cart-item">
            <span class="cart-item-name">${product.name}</span>
            <div class="cart-item-details">
              <span class="cart-item-quantity">${quantity}x</span>
              <span class="cart-item-price">R$ ${itemTotal}</span>
            </div>
          </div>
        `;
      });
      
      cartItemsContainer.innerHTML = cartHTML;
      totalPriceElement.textContent = `R$ ${total}`;
      cartTotal.style.display = 'flex';
    }

    // Inicializar SDKs
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities,
        mapToEditPanelValues
      });
    }

    // Data SDK - Inicializa√ß√£o mais robusta
    const dataHandler = {
      onDataChanged(data) {
        console.log('üìä Planilha atualizada:', data.length, 'pedidos salvos');
      }
    };

    async function initializeDataSdk() {
      console.log('üîÑ Conectando com a planilha...');
      
      // Aguardar o SDK estar dispon√≠vel
      let attempts = 0;
      const maxAttempts = 50;
      
      while (!window.dataSdk && attempts < maxAttempts) {
        console.log(`‚è≥ Aguardando SDK... tentativa ${attempts + 1}/${maxAttempts}`);
        await new Promise(resolve => setTimeout(resolve, 200));
        attempts++;
      }
      
      if (!window.dataSdk) {
        console.error('‚ùå Data SDK n√£o dispon√≠vel ap√≥s', maxAttempts * 200, 'ms');
        return false;
      }
      
      try {
        console.log('üöÄ Inicializando Data SDK...');
        const result = await window.dataSdk.init(dataHandler);
        
        if (result.isOk) {
          isDataSdkReady = true;
          console.log('‚úÖ Data SDK conectado com sucesso!');
          showToast('‚úÖ Planilha conectada!', 2000);
          return true;
        } else {
          console.error('‚ùå Erro na inicializa√ß√£o:', result.error);
          return false;
        }
      } catch (error) {
        console.error('‚ùå Exce√ß√£o na inicializa√ß√£o:', error);
        return false;
      }
    }

    // M√∫ltiplas tentativas de inicializa√ß√£o
    async function ensureDataSdkReady() {
      if (isDataSdkReady) return true;
      
      console.log('üîÑ Tentando conectar planilha...');
      
      // Primeira tentativa imediata
      if (await initializeDataSdk()) return true;
      
      // Segunda tentativa ap√≥s 1 segundo
      await new Promise(resolve => setTimeout(resolve, 1000));
      if (await initializeDataSdk()) return true;
      
      // Terceira tentativa ap√≥s mais 2 segundos
      await new Promise(resolve => setTimeout(resolve, 2000));
      return await initializeDataSdk();
    }

    // Inicializar quando DOM carregar
    document.addEventListener('DOMContentLoaded', ensureDataSdkReady);
    
    // Tamb√©m tentar imediatamente
    setTimeout(ensureDataSdkReady, 500);

    let selectedDate = null;

    // Fun√ß√µes auxiliares
    function showToast(message, duration = 3000) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('show');
      setTimeout(() => {
        toast.classList.remove('show');
      }, duration);
    }

    function generateOrderId() {
      const now = new Date();
      const timestamp = now.getTime().toString().slice(-6);
      return `BOLLI${timestamp}`;
    }

    function generateOrderItemsText() {
      let itemsText = '';
      Object.keys(cart).forEach(productId => {
        const product = products.find(p => p.id == productId);
        const quantity = cart[productId];
        itemsText += `${product.name} (${quantity}x), `;
      });
      return itemsText.slice(0, -2); // Remove √∫ltima v√≠rgula
    }

    function calculateTotal() {
      let total = 0;
      Object.keys(cart).forEach(productId => {
        const product = products.find(p => p.id == productId);
        const quantity = cart[productId];
        total += product.price * quantity;
      });
      return total;
    }

    function generateAvailableDates() {
      const dateContainer = document.getElementById('dateOptions');
      const today = new Date();
      const dates = [];
      
      // Gerar pr√≥ximos 14 dias (excluindo domingos)
      for (let i = 1; i <= 20; i++) {
        const date = new Date(today);
        date.setDate(today.getDate() + i);
        
        // Pular domingos (0 = domingo)
        if (date.getDay() !== 0) {
          dates.push(date);
        }
        
        if (dates.length >= 10) break; // Mostrar 10 datas dispon√≠veis
      }
      
      dateContainer.innerHTML = '';
      dates.forEach((date, index) => {
        const dateDiv = document.createElement('div');
        dateDiv.className = 'date-option';
        dateDiv.onclick = () => selectDate(date, dateDiv);
        
        const dayName = date.toLocaleDateString('pt-BR', { weekday: 'short' });
        const dayNumber = date.getDate();
        const month = date.toLocaleDateString('pt-BR', { month: 'short' });
        
        dateDiv.innerHTML = `
          <div style="font-size: 0.8em; opacity: 0.8;">${dayName}</div>
          <div style="font-size: 1.2em; font-weight: bold;">${dayNumber}</div>
          <div style="font-size: 0.8em; opacity: 0.8;">${month}</div>
        `;
        
        dateContainer.appendChild(dateDiv);
      });
    }

    function selectDate(date, element) {
      // Remove sele√ß√£o anterior
      document.querySelectorAll('.date-option').forEach(el => el.classList.remove('selected'));
      
      // Adiciona sele√ß√£o atual
      element.classList.add('selected');
      selectedDate = date;
    }

    function toggleDeliveryAddress() {
      const deliveryType = document.querySelector('input[name="deliveryType"]:checked').value;
      const addressSection = document.getElementById('deliveryAddress');
      
      if (deliveryType === 'delivery') {
        addressSection.classList.add('show');
        document.getElementById('address').required = true;
      } else {
        addressSection.classList.remove('show');
        document.getElementById('address').required = false;
      }
    }

    function updateOrderSummary() {
      const summaryContainer = document.getElementById('orderSummary');
      let summaryHTML = '';
      let total = 0;
      
      Object.keys(cart).forEach(productId => {
        const product = products.find(p => p.id == productId);
        const quantity = cart[productId];
        const itemTotal = product.price * quantity;
        total += itemTotal;
        
        summaryHTML += `
          <div class="summary-item">
            <span>${product.name} (${quantity}x)</span>
            <span>R$ ${itemTotal}</span>
          </div>
        `;
      });
      
      const advancePayment = Math.ceil(total * 0.5);
      
      summaryHTML += `
        <div class="summary-total">
          <div class="summary-item">
            <span>Total do Pedido:</span>
            <span>R$ ${total}</span>
          </div>
          <div class="summary-item" style="color: #FFFBE3; font-size: 1.1em;">
            <span>Pagamento Antecipado (50%):</span>
            <span>R$ ${advancePayment}</span>
          </div>
        </div>
      `;
      
      summaryContainer.innerHTML = summaryHTML;
    }

    function openCheckout() {
      updateOrderSummary();
      generateAvailableDates();
      document.getElementById('checkoutModal').classList.add('show');
      document.body.style.overflow = 'hidden';
    }

    function closeCheckout() {
      document.getElementById('checkoutModal').classList.remove('show');
      document.body.style.overflow = 'auto';
      
      // Limpar formul√°rio
      document.getElementById('checkoutForm').reset();
      selectedDate = null;
      document.querySelectorAll('.date-option').forEach(el => el.classList.remove('selected'));
      toggleDeliveryAddress();
    }

    document.getElementById('orderButton').addEventListener('click', function() {
      if (Object.keys(cart).length === 0) {
        showToast('Adicione produtos ao carrinho primeiro!');
        return;
      }
      
      openCheckout();
    });

    document.getElementById('checkoutForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      console.log('üìù Processando pedido...');
      
      // Garantir que o SDK est√° pronto
      if (!isDataSdkReady) {
        console.log('üîÑ SDK n√£o est√° pronto, tentando conectar...');
        showToast('üîÑ Conectando com a planilha...');
        
        const connected = await ensureDataSdkReady();
        if (!connected) {
          showToast('‚ùå Erro de conex√£o. Clique em "Use in a design" para usar a planilha.');
          return;
        }
      }
      
      // Validar se uma data foi selecionada
      if (!selectedDate) {
        showToast('Por favor, selecione uma data para entrega/retirada!');
        return;
      }
      
      // Validar endere√ßo se for entrega
      const deliveryType = document.querySelector('input[name="deliveryType"]:checked').value;
      if (deliveryType === 'delivery' && !document.getElementById('address').value.trim()) {
        showToast('Por favor, preencha o endere√ßo para entrega!');
        return;
      }
      
      // Mostrar loading
      const submitBtn = document.querySelector('.btn-primary');
      const originalText = submitBtn.textContent;
      submitBtn.textContent = 'Salvando pedido...';
      submitBtn.disabled = true;
      
      try {
        // Preparar dados do pedido com valida√ß√£o
        const customerName = document.getElementById('customerName').value.trim();
        const customerEmail = document.getElementById('customerEmail').value.trim();
        const customerPhone = document.getElementById('customerPhone').value.trim();
        
        if (!customerName || !customerEmail || !customerPhone) {
          throw new Error('Todos os campos obrigat√≥rios devem ser preenchidos');
        }
        
        const orderData = {
          customer_name: customerName,
          customer_email: customerEmail,
          customer_phone: customerPhone,
          delivery_type: deliveryType === 'pickup' ? 'Retirada na loja' : 'Entrega',
          delivery_address: deliveryType === 'delivery' ? document.getElementById('address').value.trim() : '',
          delivery_complement: deliveryType === 'delivery' ? document.getElementById('addressComplement').value.trim() : '',
          delivery_date: selectedDate.toLocaleDateString('pt-BR'),
          order_items: generateOrderItemsText(),
          total_amount: calculateTotal(),
          advance_payment: Math.ceil(calculateTotal() * 0.5),
          order_date: new Date().toISOString(),
          order_id: generateOrderId()
        };
        
        console.log('Dados do pedido preparados:', orderData);
        
        // Verificar se o SDK ainda est√° dispon√≠vel
        if (!window.dataSdk) {
          throw new Error('SDK n√£o est√° dispon√≠vel');
        }
        
        // Salvar na planilha
        console.log('Tentando salvar na planilha...');
        const result = await window.dataSdk.create(orderData);
        console.log('Resultado da opera√ß√£o:', result);
        
        if (result.isOk) {
          console.log('Pedido salvo com sucesso!');
          closeCheckout();
          
          // Limpar carrinho
          cart = {};
          for (let i = 1; i <= 6; i++) {
            document.getElementById(`quantity${i}`).textContent = '0';
          }
          updateCart();
          
          showToast('‚úÖ Pedido recebido! Voc√™ receber√° mais informa√ß√µes por whatsapp', 4000);
        } else {
          console.error('Erro do Data SDK:', result.error);
          const errorMsg = result.error?.message || 'Erro desconhecido';
          showToast(`‚ùå Erro ao salvar: ${errorMsg}`);
        }
      } catch (error) {
        console.error('Erro ao processar pedido:', error);
        showToast(`‚ùå Erro: ${error.message || 'Erro desconhecido'}`);
      } finally {
        submitBtn.textContent = originalText;
        submitBtn.disabled = false;
      }
    });
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'99a5c18286c8ad9c',t:'MTc2MjQ0NDMyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
